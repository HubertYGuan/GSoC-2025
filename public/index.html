<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.147.6"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Porting Printing to Zephyr - GSoC 2025</title><meta name=keywords content="Blog,GSoC,Zephyr,OpenPrinting"><meta name=description content="GSoC 2025 Project in Collaboration with OpenPrinting and Zephyr"><meta name=author content="Hubert Guan"><link rel=canonical href=https://HubertYGuan.github.io/GSoC-2025/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/GSoC-2025/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://HubertYGuan.github.io/GSoC-2025/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://HubertYGuan.github.io/GSoC-2025/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://HubertYGuan.github.io/GSoC-2025/favicon-32x32.png><link rel=apple-touch-icon href=https://HubertYGuan.github.io/GSoC-2025/apple-touch-icon.png><link rel=mask-icon href=https://HubertYGuan.github.io/GSoC-2025/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://HubertYGuan.github.io/GSoC-2025/index.xml><link rel=alternate hreflang=en href=https://HubertYGuan.github.io/GSoC-2025/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=GA4-123-45"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","GA4-123-45")}</script><meta property="og:url" content="https://HubertYGuan.github.io/GSoC-2025/"><meta property="og:site_name" content="Porting Printing to Zephyr - GSoC 2025"><meta property="og:title" content="Porting Printing to Zephyr - GSoC 2025"><meta property="og:description" content="GSoC 2025 Project in Collaboration with OpenPrinting and Zephyr"><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta property="og:image" content="https://HubertYGuan.github.io/GSoC-2025/images/openprintingzephyr.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://HubertYGuan.github.io/GSoC-2025/images/openprintingzephyr.png"><meta name=twitter:title content="Porting Printing to Zephyr - GSoC 2025"><meta name=twitter:description content="GSoC 2025 Project in Collaboration with OpenPrinting and Zephyr"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Porting Printing to Zephyr - GSoC 2025","url":"https://HubertYGuan.github.io/GSoC-2025/","description":"GSoC 2025 Project in Collaboration with OpenPrinting and Zephyr","logo":"https://HubertYGuan.github.io/GSoC-2025/favicon.ico","sameAs":["https://linkedin.com/in/hubertyguan","https://github.com/HubertYGuan"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://HubertYGuan.github.io/GSoC-2025/ accesskey=h title="Home (Alt + H)"><img src=https://HubertYGuan.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://github.com/HubertYGuan title="About Me"><span>About Me</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://github.com/HubertYGuan/zlib title="GitHub Repos"><span>GitHub Repos</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class="first-entry home-info"><header class=entry-header><h1>Porting Printing to Zephyr </h1></header><div class=entry-content>Welcome to my webpage where you can find updates and info on my project for GSoC 2025 and beyond.</div><footer class=entry-footer><div class=social-icons><a href=https://linkedin.com/in/hubertyguan target=_blank rel="noopener noreferrer me" title=Linkedin><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</a><a href=https://github.com/HubertYGuan target=_blank rel="noopener noreferrer me" title=Github><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></div></footer></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>GSoC 2025 Final Report: Porting CUPS to Zephyr</h2></header><div class=entry-content><p>Project Overview The main objective of this project is to bring OpenPrintings open source printing stack to resource-constrained systems using the Zephyr RTOS. This is motivated by the current lack of embedded, real-time print server solutions, which could open the door to highly efficient and closely coupled print server and printer hardware development. Furthermore, the boundaries for power and resource consumption in printing would be pushed further with the elimination of the overhead of operating systems like embedded Linux. For this project, only the topic of running a print server on Zephyr is explored, but future work in hardware integration is ripe for exploration.
...</p></div><footer class=entry-footer><span title='2025-11-07 02:29:12 -0800 PST'>November 7, 2025</span>&nbsp;路&nbsp;7 min&nbsp;路&nbsp;1426 words&nbsp;路&nbsp;Hubert Guan</footer><a class=entry-link aria-label="post link to GSoC 2025 Final Report: Porting CUPS to Zephyr" href=https://HubertYGuan.github.io/GSoC-2025/posts/final/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Week 20: Setting Up PAPPL and Wrapping Up</h2></header><div class=entry-content><p>This is another short status update on PAPPL and the project in general. I have mainly spent this week modifying PAPPL source code to fit the current use case on Zephyr. The project I have does compile (although many of the allocated stacks/pools are shrunk due to the increased memory requirements). Currently, I am dealing with some issues related to thread local storage/stack pointer stuff as seen below:
D: (): zsock_getaddrinfo: host: , service: 8000, hints: 0x3c5f31f0 D: (): socket: ctx=0x3fccd3f8, fd=8 I: Listening for connections on ':1012871920'. E: ** FATAL EXCEPTION E: ** CPU 0 EXCCAUSE 28 (load prohibited) E: ** PC 0x420a50ae VADDR 0xc E: ** PS 0x60c20 E: ** (INTLEVEL:0 EXCM: 0 UM:1 RING:0 WOE:1 OWB:12 CALLINC:2) E: ** A0 0x820b74e8 SP 0x3c5f3510 A2 0x3fcd3c90 A3 (nil) E: ** A4 0x3c5f34e0 A5 0x3fcd4890 A6 (nil) A7 0x4207f3e0 E: ** A8 0x820b7460 A9 0x3c5f30c0 A10 0x3fcd3c90 A11 0x3c5f34e0 E: ** A12 0x1 A13 0x1 A14 0xa0 A15 0xc E: ** LBEG 0x400556d5 LEND 0x400556e5 LCOUNT 0xfffffffc E: ** SAR 0x1e E: ** THREADPTR (nil) E: >>> ZEPHYR FATAL ERROR 0: CPU exception on CPU 0 E: Current thread: 0x3fcc22d0 (unknown) E: Halting system The main things that I have had to remove or will need to remove in the future are listed here:
...</p></div><footer class=entry-footer><span title='2025-11-04 01:37:14 -0800 PST'>November 4, 2025</span>&nbsp;路&nbsp;2 min&nbsp;路&nbsp;379 words&nbsp;路&nbsp;Hubert Guan</footer><a class=entry-link aria-label="post link to Week 20: Setting Up PAPPL and Wrapping Up" href=https://HubertYGuan.github.io/GSoC-2025/posts/week20/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Week 19: Wrapping up libcups Testing For Now</h2></header><div class=entry-content><p>This is a short status update on testing for libcups and PAPPL for the week (I cant write that much since it is currently midterm season for me). Firstly, I have implemented the semaphores for sys_heap functions that I mentioned earlier. However, I have not extensively tested the new multithreaded sys_heap behavior with these semaphores. It seems like there are no current conflicts with the WiFi thread running in the external heap and the main thread interacting with the external heap at least.
...</p></div><footer class=entry-footer><span title='2025-10-29 02:10:59 -0700 PDT'>October 29, 2025</span>&nbsp;路&nbsp;2 min&nbsp;路&nbsp;265 words&nbsp;路&nbsp;Hubert Guan</footer><a class=entry-link aria-label="post link to Week 19: Wrapping up libcups Testing For Now" href=https://HubertYGuan.github.io/GSoC-2025/posts/week19/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Week 17/18: Testing with the New Memory Management Scheme</h2></header><div class=entry-content><p>I had to combine these two weeks into one report since I generally do not have much time to work during the first half of the week since thats when I have to spend the most time on schoolwork (now that the academic term has fully begun). I was able to focus on testing during the last few days and have discovered some important information, and I should be able to progress to testing PAPPL relatively soon.
...</p></div><footer class=entry-footer><span title='2025-10-20 01:35:03 -0700 PDT'>October 20, 2025</span>&nbsp;路&nbsp;3 min&nbsp;路&nbsp;493 words&nbsp;路&nbsp;Hubert Guan</footer><a class=entry-link aria-label="post link to Week 17/18: Testing with the New Memory Management Scheme" href=https://HubertYGuan.github.io/GSoC-2025/posts/weeks17-18/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Week 16: ippeveprinter Woes and Updated Plans</h2></header><div class=entry-content><p>From what I could gather this week when working on ippeveprinter, it is likely not going to be running on Zephyr any time soon. The reality is that ippeveprinter is 8k lines of code without some kind of modular testbench and that it is clearly not written for embedded systems (besides embedded Linux devices, which have traits of traditional computer systems). It has also become a debugging nightmare to get through since logs are not clear as to what exactly is going wrong and there is not much comparison with regular ippeveprinter on Linux since most of the logs disappear if nothing goes wrong. Furthermore, step-through debugging is not the best when testing a real-time connection HTTP connection that can timeout. Lastly, it takes a lot of overhead time just to reset my testing setup since ippfind can often have trouble finding ippeveprinter.
...</p></div><footer class=entry-footer><span title='2025-10-10 00:26:46 -0700 PDT'>October 10, 2025</span>&nbsp;路&nbsp;3 min&nbsp;路&nbsp;593 words&nbsp;路&nbsp;Hubert Guan</footer><a class=entry-link aria-label="post link to Week 16: ippeveprinter Woes and Updated Plans" href=https://HubertYGuan.github.io/GSoC-2025/posts/week16/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Week 15: More pthread and Memory Adventures in ippeveprinter</h2></header><div class=entry-content><p>This week has definitely had many ups and downs in terms of this project and my work now that I am officially starting my Fall quarter. Surprisingly (or unsurprisingly due to reasons I will get into), I have not had that much time to work on this project despite classes being basically nonexistent in terms of assignments (with the exception of the embedded systems course ECE 153a that makes me go into Vivado even before the first lecture). The main thing that has been taking up my time is working on a new initiative with the ACM student chapter at UCSB, which involves managing communications with much of the faculty from two departments and many meetings for event planning.
...</p></div><footer class=entry-footer><span title='2025-10-02 00:47:49 -0700 PDT'>October 2, 2025</span>&nbsp;路&nbsp;4 min&nbsp;路&nbsp;783 words&nbsp;路&nbsp;Hubert Guan</footer><a class=entry-link aria-label="post link to Week 15: More pthread and Memory Adventures in ippeveprinter" href=https://HubertYGuan.github.io/GSoC-2025/posts/week15/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Week 14: ippeveprinter Configuration, DNS-SD, and HTTP</h2></header><div class=entry-content><p>I had more time this week to work on and debug the DNS-SD services and functionality of ippeveprinter. I was able to figure out how to get ippeveprinter recognized as a printer by CUPS, but Ive also had a lot more issues with processing jobs.
First, I noticed that I have to load a test.conf file, or else seemingly every job will fail when running on my local machine. It turns out that the load_ippserver_attributes is very memory-intensive, and I was only able to get it to work after increasing a bunch of stack sizes in the kconfig (see source code). This means that I have only about 5% of my DRAM available for the heap, and I am also unsure if my pthread stacks are large enough to handle the HTTP functions either.
...</p></div><footer class=entry-footer><span title='2025-09-23 16:07:55 -0700 PDT'>September 23, 2025</span>&nbsp;路&nbsp;6 min&nbsp;路&nbsp;1085 words&nbsp;路&nbsp;Hubert Guan</footer><a class=entry-link aria-label="post link to Week 14: ippeveprinter Configuration, DNS-SD, and HTTP" href=https://HubertYGuan.github.io/GSoC-2025/posts/week14/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Week 13: Short ippeveprinter Update</h2></header><div class=entry-content><p>As I alluded to in my previous post, I did not have much time to work on ippeveprinter this week, but I did manage to figure out what was wrong before. Now, mostly DNS-SD and networking work remains to be done.
As for the previous issue I faced, I figured out that it was caused by a lack of available stack memory for ippeve_main and that I actually had to malloc the stack myself since the default pthread_attr allocation method conflicts with the net management allocations for some reason (if I allocate one, the other will fail to allocate unless I set the stack size low enough).
...</p></div><footer class=entry-footer><span title='2025-09-16 22:16:36 -0700 PDT'>September 16, 2025</span>&nbsp;路&nbsp;2 min&nbsp;路&nbsp;304 words&nbsp;路&nbsp;Hubert Guan</footer><a class=entry-link aria-label="post link to Week 13: Short ippeveprinter Update" href=https://HubertYGuan.github.io/GSoC-2025/posts/week13/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Week 12: More Debugging</h2></header><div class=entry-content><p>Although I was not able to work very much this week, I was able to delve further into running ippeveprinter, and I also have an update on JTAG debugging. I was able to resolve the previous issues about pthreads for now, as well as most of my previous issues with debugging, but there is now a whole new suite of issues for me to deal with.
ippeveprinter After running ippeveprinter in a pthread, I noticed that I would either get stuck somewhere spinning indefinitely or get the following store-prohibited error:
...</p></div><footer class=entry-footer><span title='2025-09-08 23:41:54 -0700 PDT'>September 8, 2025</span>&nbsp;路&nbsp;4 min&nbsp;路&nbsp;755 words&nbsp;路&nbsp;Hubert Guan</footer><a class=entry-link aria-label="post link to Week 12: More Debugging" href=https://HubertYGuan.github.io/GSoC-2025/posts/week12/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Week 11: ippeveprinter Continued</h2></header><div class=entry-content><p>This week was mainly spent trying to figure out all of the small issues in trying to translate ippeveprinter and libcups functionality over from Linux. Ive learned more about how Zephyr handles concepts like pthreads and how they can be a lot more difficult to deal with than on Linux. I also recently received my ESP32s3 board, so I have also been testing the application there as well.
ippeveprinter Update Luckily, it seems that using the previously mentioned syscalls like pipe, dup, and execve are not entirely necessary for the functioning of ippeveprinter since those are only used to execute user-defined bash commands for incoming print jobs. However, something else has become the main problem with implementing the rest of ippeveprinter: pthreads. Since libcups uses pthread keys to manage its globals, Ive had issues every time Ive tried to initiate and store globals. Mainly, pthread_setspecific will return EINVAL since to_posix_thread(pthread_self()) will fail. Inside of pthread_self:
...</p></div><footer class=entry-footer><span title='2025-09-01 18:56:48 -0700 PDT'>September 1, 2025</span>&nbsp;路&nbsp;3 min&nbsp;路&nbsp;597 words&nbsp;路&nbsp;Hubert Guan</footer><a class=entry-link aria-label="post link to Week 11: ippeveprinter Continued" href=https://HubertYGuan.github.io/GSoC-2025/posts/week11/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://HubertYGuan.github.io/GSoC-2025/page/2/>Next&nbsp;&nbsp;禄</a></nav></footer></main><footer class=footer><span>漏 Hubert Guan, OpenPrinting, Zephyr</span> 路
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>